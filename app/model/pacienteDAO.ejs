function pacienteDAO(application){
	var conection = require('./../../config/dbConnection');
	this._conection = conection();
}
pacienteDAO.prototype.autenticar = function(usuario, senha, unidade, funcao, req, res){
	var usuario = usuario;
	var senha = senha;
	var unidade = unidade;
	var funcao = funcao;
	if(funcao == 'SCIH'){
		if (usuario && senha) {
			this._conection.query('SELECT * FROM usuarios WHERE usuario = ? AND senha = ?', [usuario, senha], function(error, results, fields) {
				
					if (results.length > 0) {
						if(results[0].scih == 1){
						req.session.loggedin = true;
						req.session.usuario = results[0].usuario;
						res.render('home/home', {id : results});
					} else {
						
						res.render("home/index", {
							error: req.flash("Usuario ou senha incorreto"), 
						  });
					}			
				}
				else{
					res.render("home/index", {
						error: req.flash("Você não tem autorização para esse modulo"), 
					  });	
				}
				res.end();
			});
		} else {
			res.render("home/index", {
				error: req.flash("Entre com usuario e senha, por favor!!"), 
			  });
		}
	}else{
		if (usuario && senha) {
			this._conection.query('SELECT * FROM usuarios WHERE usuario = ? AND senha = ?', [usuario, senha], function(error, results, fields) {
				
					if (results.length > 0) {
						if(results[0].regulacao == 1){
						req.session.loggedin = true;
						req.session.usuario = results[0].usuario;

						res.render('home/homeregulacao', {id : results});
					} else {
						res.render("home/index", {
							error: req.flash("Usuario ou senha incorreto"), 
						  });
					}			
				}
				else{
					res.render("home/index", {
						error: req.flash("Você não tem autorização para esse modulo"), 
					  });	
				}
				res.end();
			});
		} else {
			res.render("home/index", {
				error: req.flash("Entre com usuario e senha, por favor!!"), 
			  });
	}
}
			
}

pacienteDAO.prototype.updatepassword = function(usuario, senha,  callback){

	this._conection.query('select id_usuario from usuarios where usuario = "'+usuario+'" and senha = "'+senha+'"', callback);
}
pacienteDAO.prototype.mudarsenha = function(id, senha,  callback){
	var idusuario = id[0].id_usuario;
	
	this._conection.query('update usuarios set senha =  "'+senha+'" where id_usuario = "'+idusuario+'"', callback);
}
pacienteDAO.prototype.cadastrarpaciente = function(paciente, susfacil, idade, leito,exame, callback){

	this._conection.query('insert into pacientes set susfacil = "'+susfacil+'", paciente = "'+paciente+'", leito = "'+leito+'", idade = "'+idade+'", news = "" , dispositivo = "" , fluxo_de_o2 = "" , droga = "" , fio2 = "" ,peep = "" ,sedacao = "" , glasgow = "" , tempo = "" ,exame = "'+exame+'"', callback);
}

pacienteDAO.prototype.update = function(idpaciente, susfacil, paciente, leito, idade, exame, callback){

	this._conection.query('update pacientes set susfacil = "'+susfacil+'", paciente = "'+paciente+'", leito = "'+leito+'", idade = "'+idade+'" , exame = "'+exame+'" where id_paciente = ' + idpaciente, callback);
}
pacienteDAO.prototype.updateleitosanexo = function(idleitos, enfermariamasculina,enfermariafeminina,utigeral,utimasculina, utifeminina, leitosenfbloqueado,leitosutibloqueado, callback){
	

	this._conection.query('update leitosdisponivel set enfermariaanexofeminino = "'+enfermariafeminina+'", enfermariaanexomasculino = "'+enfermariamasculina+'",utigeralanexo = "'+utigeral+'", utianexofeminino = "'+utifeminina+'",utianexomasculino = "'+utimasculina+'", leitosbloqueadoutianexo="'+leitosutibloqueado+'", leitosbloqueadoenfermariaanexo="'+leitosenfbloqueado+'" where idleitos = ' + idleitos, callback);
}

pacienteDAO.prototype.updateleitoscim = function(idleitos, enfermariamasculina,enfermariafeminina, leitosenfbloqueado, callback){
	

	this._conection.query('update leitosdisponivel set enfermariacimfeminino = "'+enfermariafeminina+'", enfermariacimmasculino = "'+enfermariamasculina+'", leitosbloqueadoenfermariacim = "'+leitosenfbloqueado+'" where idleitos = ' + idleitos, callback);
}

pacienteDAO.prototype.updateleitoshmu = function(idleitos,uti,leitosutibloqueado, callback){
	

	this._conection.query('update leitosdisponivel set utivagas = "'+uti+'", leitosbloqueadoutihmu = "'+leitosutibloqueado+'" where idleitos = ' + idleitos, callback);
}

pacienteDAO.prototype.updateleitosluizote = function(idleitos,enffem,enfmasc,leitosdispo,macasdispo,se, callback){
	

	this._conection.query('update leitosdisponivel set macasluidisponivel = "'+macasdispo+'", leitoslui = "'+leitosdispo+'",enfluifem = "'+enffem+'",enfluimasc = "'+enfmasc+'",selui = "'+se+'" where idleitos = ' + idleitos, callback);
}

pacienteDAO.prototype.updateleitosplanalto = function(idleitos,enffem,enfmasc,leitosdispo,macasdispo,se, callback){
	
	this._conection.query('update leitosdisponivel set macaspladisponivel = "'+macasdispo+'", leitospla = "'+leitosdispo+'",enfplafem = "'+enffem+'",enfplamasc = "'+enfmasc+'",sepla = "'+se+'" where idleitos = ' + idleitos, callback);

}

pacienteDAO.prototype.updateleitosmartins = function(idleitos,enffem,enfmasc,leitosdispo,macasdispo,se, callback){
	
	this._conection.query('update leitosdisponivel set macasmardisponivel = "'+macasdispo+'", leitosmar = "'+leitosdispo+'",enfmarfem = "'+enffem+'",enfmarmasc = "'+enfmasc+'",semar = "'+se+'" where idleitos = ' + idleitos, callback);
}

pacienteDAO.prototype.updateleitosroosevelt = function(idleitos,enffem,enfmasc,leitosdispo,macasdispo,se, callback){
	
	this._conection.query('update leitosdisponivel set macasroodisponivel = "'+macasdispo+'", leitosroo = "'+leitosdispo+'",enfroofem = "'+enffem+'",enfroomasc = "'+enfmasc+'",seroo = "'+se+'" where idleitos = ' + idleitos, callback);
}

pacienteDAO.prototype.updateleitosmorumbi = function(idleitos,enffem,enfmasc,leitosdispo,macasdispo,se, callback){
	
	this._conection.query('update leitosdisponivel set macasmorumdisponivel = "'+macasdispo+'", leitosmorum = "'+leitosdispo+'",enfmorumfem = "'+enffem+'",enfmorummasc = "'+enfmasc+'",semorum = "'+se+'" where idleitos = ' + idleitos, callback);
}

pacienteDAO.prototype.updateleitostibery = function(idleitos,enffem,enfmasc,leitosdispo,macasdispo,se, callback){
	
	this._conection.query('update leitosdisponivel set macastibedisponivel = "'+macasdispo+'", leitostibe = "'+leitosdispo+'",enftibefem = "'+enffem+'",enftibemasc = "'+enfmasc+'",setibe = "'+se+'" where idleitos = ' + idleitos, callback);
}


pacienteDAO.prototype.updateleitossaojorge = function(idleitos,enffem,enfmasc,leitosdispo,macasdispo,se, callback){

	this._conection.query('update leitosdisponivel set macassaojodisponivel = "'+macasdispo+'", leitossaojo = "'+leitosdispo+'",enfsaojofem = "'+enffem+'",enfsaojomasc = "'+enfmasc+'",sesaojo = "'+se+'" where idleitos = ' + idleitos, callback);
}

pacienteDAO.prototype.updateleitospampulha = function(idleitos,enffem,enfmasc,leitosdispo,macasdispo,se, callback){

	this._conection.query('update leitosdisponivel set macaspampudisponivel = "'+macasdispo+'", leitospampu = "'+leitosdispo+'",enfpampufem = "'+enffem+'",enfpampumasc = "'+enfmasc+'",sepampu = "'+se+'" where idleitos = ' + idleitos, callback);
}

pacienteDAO.prototype.buscarleito = function(callback){
	
	this._conection.query('select * from leitosdisponivel where idleitos = "1" ', callback);
}

pacienteDAO.prototype.buscarleitouti = function(callback){
	
	this._conection.query('select * from leitosdisponivel where idleitos = "1" ', callback);
}

pacienteDAO.prototype.buscarleitoenfermaria = function(callback){
	
	this._conection.query('select * from leitosdisponivel where idleitos = "1" ', callback);
}

pacienteDAO.prototype.updatenews = function(idpaciente, news,tempo, callback){

	this._conection.query('update pacientes set  news = "'+news+'", tempo = "'+tempo+'"  where id_paciente = ' + idpaciente, callback);
}

pacienteDAO.prototype.updateresp = function(idpaciente,dispositivo,fluxoo2, droga, fio2, peep, sedacao, glasgow,leito, callback){
	

	this._conection.query('update pacientes set   dispositivo = "'+dispositivo+'", fluxo_de_o2 = "'+fluxoo2+'", droga = "'+droga+'", fio2 = "'+fio2+'", peep = "'+peep+'", sedacao = "'+sedacao+'", glasgow = "'+glasgow+'", acomodacao = "'+leito+'" where id_paciente = ' + idpaciente, callback);
}

pacienteDAO.prototype.delete = function(idpaciente, callback){

	this._conection.query('delete from pacientes  where id_paciente = ' + idpaciente, callback);
}

pacienteDAO.prototype.buscarusuarioeditavel = function(id, callback){
	
	this._conection.query('select * from usuarios where id_usuario = ' + id, callback);
}

pacienteDAO.prototype.buscarusuario = function(id, callback){
	
	this._conection.query('select * from usuarios where id_usuario = ' + id.id, callback);
}

pacienteDAO.prototype.buscarusuarioporid = function(id, callback){
	
	this._conection.query('select * from usuarios where id_usuario = ' + id, callback);
}
pacienteDAO.prototype.buscarpaciente = function(callback){
	
	this._conection.query('select * from pacientes', callback);
}

pacienteDAO.prototype.buscarpacienteporordemprioridade = function(callback){
	
	this._conection.query('select * from pacientes order by news desc', callback);
}

pacienteDAO.prototype.buscarpacienteid = function(idpaciente, callback){
	this._conection.query('select * from pacientes where id_paciente = ' + idpaciente.id, callback);
}



module.exports = function(){
	return pacienteDAO;
}